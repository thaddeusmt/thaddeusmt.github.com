
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Chili Pepper Design</title>
  <meta name="author" content="Evan Johnson">

  
  <meta name="description" content="CKEditor is the new and improved successor to the venerable FCKeditor JavaScript WYSIWYG editor. I&#8217;ve used TinyMCE and FCKeditor before, but &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://chilipepperdesign.com/blog/page/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Chili Pepper Design" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6058373-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Chili Pepper Design</a></h1>
  
    <h2>Web development relleno</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:chilipepperdesign.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/01/08/adding-the-rel-and-title-attributes-to-image-links-in-ckeditor-3/">Adding the &#8220;Rel&#8221; and &#8220;Title&#8221; Attributes to Image Links in CKEditor 3</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-08T14:37:00-06:00" pubdate data-updated="true">Jan 8<span>th</span>, 2010</time>
        
         | <a href="/2010/01/08/adding-the-rel-and-title-attributes-to-image-links-in-ckeditor-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://ckeditor.com/">CKEditor</a> is the new and improved successor to the venerable <a href="http://sourceforge.net/projects/fckeditor/files/FCKeditor/">FCKeditor</a> JavaScript <span class="caps">WYSIWYG</span> editor. I&#8217;ve used <a href="http://tinymce.moxiecode.com/">TinyMCE</a> and FCKeditor before, but this was my first time trying out the new CKEditor 3.1. I am using it on a new Drupal website via the <a href="http://drupal.org/project/ckeditor">Drupal CKEditor module</a>. The problem I ran into, however, is using <a href="http://www.huddletogether.com/projects/lightbox2/">Lightbox2</a> on images inserted via CKEditor. CK does not provide a way to add the &#8220;rel&#8221; attribute to image links (or any links for that matter). CK also doesn&#8217;t allow adding the &#8220;title&#8221; attribute to image links. Lightbox uses both of these to determine which images to display, group together in galleries, provide a caption, etc. I found <a href="http://dev.fckeditor.net/attachment/ticket/2627/fck-rel.patch">a patch for FCKeditor</a> which allows adding a &#8220;rel&#8221; attribute to image links, but I couldn&#8217;t find one for the new CKEditor. So here we are. :)</p>
<p>This is a total hack, since I have not looked in to how to properly make a plugin for the new CKEditor, but it works pretty well. Maybe someone who knows how to make plugins to CKEditor can show me the way.</p>
<p></div>
  
  
    <footer>
      <a rel="full-article" href="/2010/01/08/adding-the-rel-and-title-attributes-to-image-links-in-ckeditor-3/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/01/03/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-3/">Configuring and Compiling Nginx and PHP-FPM on Ubuntu for Magento, Part 3</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-03T20:47:00-06:00" pubdate data-updated="true">Jan 3<span>rd</span>, 2010</time>
        
         | <a href="/2010/01/03/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is the 3rd and final article about installing Magento on Nginx with <span class="caps">PHP</span>-<span class="caps">FPM</span>. <a href="http://www.chilipepperdesign.com/2009/12/14/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-1">Part 1 is here</a>, and <a href="http://www.chilipepperdesign.com/2009/12/18/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-2">Part 2 is here</a>.</p>
<p>This part explains how I set up my public web directories, and how I did the Nginx configuration files for a Magento site. One of the tricky things about switching to Nginx from Apache is that Nginx does not use .htaccess files or the usual Apache mod_rewrite rules for pretty/<span class="caps">SEO</span> URLs. You can replicate all of Magento&#8217;s mod_rewrite rules with Nginx&#8217;s own rewrite module, but it takes some getting used to and Magento doesn&#8217;t come with them pre-written (like the mod_rewrite rules in the .htaccess files).</p>
<p>Here are some of the resources I used:</p>
<ul>
<li><a href="http://articles.slicehost.com/2009/3/6/ubuntu-intrepid-nginx-virtual-hosts-1">Slicehost: Nginx Virtual Hosts #1</a></li>
<li><a href="http://articles.slicehost.com/2009/9/4/ubuntu-intrepid-nginx-virtual-hosts-2-2">Slicehost: Nginx Virtual Hosts #2</a></li>
<li><a href="http://www.magentocommerce.com/boards/viewthread/7931/">Magento Forum: NginX Web Server with Magento</a></li>
<li><a href="http://www.magentocommerce.com/boards/viewthread/38134/">Magento Forum: Thread about Fooman Speedster (which I never go to work)</a></li>
<li><a href="http://markmail.org/message/fdurus5iczudtm62">Random MarkMail post (I needed Google Translate to help me out)</a></li>
<li><a href="http://varien.com.ua/blog/Fustanovka-magento-dlya-raboty-s-nginx-php-fpm-apc">varien.com.ua (Also needed Google Translate to help me out)</a></li>
</ul>
<p>First we&#8217;ll set up the directory structure like we are used to with Apache:</p>

<pre><code>
# mkdir /usr/local/nginx/sites-available
# mkdir /usr/local/nginx/sites-enabled
# mkdir /var/www/example1.com/public
# mkdir /var/www/example1.com/log
# cp  /usr/local/nginx/conf/nginx.conf /usr/local/nginx/conf/nginx.conf-original
</code></pre>
<p>Then set up the base nginx conf file <em>/usr/local/nginx/conf/nginx.conf</em>:</p>

<pre><code>
user www-data;
worker_processes 1;

events {
    worker_connections 1024;
}

http {
    include mime.types;
    default_type application/octet-stream;
    sendfile on;
    keepalive_timeout 65;
    gzip on;
    include /usr/local/nginx/sites-enabled/*;
}
</code></pre>
<p>Then set up the Nginx conf file for your website. I am using the default site in this example <em>/usr/local/nginx/sites-available/default</em>, but if you have multiple sites instead of <em>default</em> you would create files called <em>site1.com</em>, <em>site2.com</em>, etc.</p>
<p>This file is where all of the rewrite magic is. The url in this example is <em>example1.com</em>, which you should replace with your own. The document root is <em>/var/www/example1.com/public</em> which, again, you will need to change to match your own configuration.</p>

<pre><code>
# fastcgi nodes
upstream  backend  {
    server unix:/tmp/fcgi.sock;
}

# redirect all non-www requests to www requests (it would be easy to reverse this)
server {
    listen   80;
    server_name  example1.com;
    rewrite ^/(.*) http://www.example1.com/$1 permanent;
}

server {
    listen       80;
    server_name www.example1.com;

    # protection (we have no .htaccess)
    location ~ (/(app/|includes/|lib/|/pkginfo/|var/|report/config.xml)|/\.svn/|/.hta.+) {
        deny all;
    }
   # pass php files over to PHP-FPM via the socket
    location ~ (\.php)$ {
        fastcgi_index index.php;
        include /etc/nginx/fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        if (-e $request_filename) { # check if requested path exists
            fastcgi_pass backend;
        }
    }
    # the javascript compressor
    location ^~ /js/index.php {
        fastcgi_pass   backend;
        fastcgi_index index.php;
        fastcgi_param  SCRIPT_NAME $fastcgi_script_name;
        fastcgi_param  SCRIPT_FILENAME  /var/www/example1.com/public$fastcgi_script_name;
        include /etc/nginx/fastcgi_params;
        access_log off;
        expires 30d;
    }
   # special case for the error "report" pages
    location /report/ {
        fastcgi_index index.php;
        include /etc/nginx/fastcgi_params;
        fastcgi_param  SCRIPT_NAME /report/index.php;
        fastcgi_param  SCRIPT_FILENAME  /var/www/example1.com/public/report/index.php;
        if (!-f $request_filename) {
            fastcgi_pass backend;
            break;
        }
    }
    # pass everything else over to PHP-FPM via the socket
    location / {
        root /var/www/example1.com/public/; # absolute path doc root
        index index.php index.html index.htm;

        # set expire headers
        if ($request_uri ~* "\.(ico|css|js|gif|jpe?g|png)$") {
            expires max;
        }
        # set fastcgi settings, not allowed in the "if" block
        include /etc/nginx/fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root/index.php;
        fastcgi_param SCRIPT_NAME /index.php;
        # rewrite - if file not found, pass it to the backend
        if (!-f $request_filename) {
            fastcgi_pass backend;
            break;
        }
        error_page 404 index.php;
    }
    access_log /var/www/example1.com/log/access.log;
    error_log /var/www/example1.com/log/error.log;
}
</code></pre>
<p>I am no expert with Nginx, but a lot of Google searching and trial and error gave me the file above, and it seems to work. I hope it is helpful, even if this exact code doesn&#8217;t work for you.</p>
<p>Finally, activate the site by creating a symbolic link to it and restarting the server:</p>

<pre><code>
# ln -s /usr/local/nginx/sites-available/default /usr/local/nginx/sites-enabled/default
# ln -s /usr/local/nginx/sites-enabled /etc/sites
# /etc/init.d/nginx restart
</code></pre>
<p>And that&#8217;s it! You should now have Magento running on Nginx! (<em>After</em>, of course, also installing mysql and a sendmail program, and probably an <span class="caps">FTP</span> server, and who knows what else :)</p>
<p>Now, how to make it actually go faster than Apache? There are many settings you can tweak. Look in <em>fastcgi_params</em> to change <span class="caps">PHP</span>-<span class="caps">FPM</span> settings, <em>php.ini</em> to change <span class="caps">APC</span> settings, <em>my.cnf</em> to change mysql settings, <em>nginx.conf</em> to adjust the number of worker processes and the keepalive timeouts&#8230; the list goes on. Good luck!</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/12/18/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-2/">Configuring and Compiling Nginx and PHP-FPM on Ubuntu for Magento, Part 2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-12-18T19:17:00-06:00" pubdate data-updated="true">Dec 18<span>th</span>, 2009</time>
        
         | <a href="/2009/12/18/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is the second part of my little guide to get Magento running on Nginx with <span class="caps">PHP</span>-<span class="caps">FPM</span> and <span class="caps">APC</span>. Check out <a href="http://www.chilipepperdesign.com/2009/12/14/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-1">Part 1 here</a> and <a href="http://www.chilipepperdesign.com/2010/01/03/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-3">Part 3 here</a>.</p>
<p>In this part, we compile <a href="http://php-fpm.org/"><span class="caps">PHP</span>-<span class="caps">FPM</span></a> and get it working with the <a href="http://php.net/manual/en/book.apc.php"><span class="caps">APC</span></a> &#8220;Accelerator&#8221; cache for Nginx. The first step is to compile <span class="caps">PHP</span>-<span class="caps">FPM</span>. Some of this is taken almost verbatim from the <span class="caps">FPM</span> <a href="http://github.com/dreamcat4/php-fpm/blob/master/readme.markdown">readme</a>:</p>
<p></div>
  
  
    <footer>
      <a rel="full-article" href="/2009/12/18/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-2/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/12/14/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-1/">Configuring and Compiling Nginx and PHP-FPM on Ubuntu for Magento, Part 1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-12-14T21:08:00-06:00" pubdate data-updated="true">Dec 14<span>th</span>, 2009</time>
        
         | <a href="/2009/12/14/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-1/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So, Magento is a huge piece of modular and extensible <span class="caps">PHP</span> code. Each request takes a lot of <span class="caps">CPU</span> cycles and memory to kick out a Magento page. This means it is <em>slow</em>. The performance of Magento is a frequent complaint, and rightfully so: consumers won&#8217;t wait around all day for an ecommerce store to load. They will bail out and try another store if a page doesn&#8217;t load in just a few seconds. A default Magento 1.3 install on budget web hosting can have page load times of up to 10secs, which is unacceptable. </p>
<p>So what can be done to speed up Magento?</p>
<p>There are a <a href="http://www.magentocommerce.com/wiki/groups/168/optimising_your_web_stack_performance_for_magento">number</a> of <a href="http://www.magentocommerce.com/blog/comments/understanding-magento-scalability-and-performance-1/">things</a>. I have tried almost all of them at this point. And I did reduce the page load time greatly, at least on the front end. But all of the AJAXy scripts on the backend (which has no caching, as far as I know) meant store maintenance and order fulfillment remained a tedious process. So I decided to try one final thing: make the switch from trusty old <a href="http://www.apache.org/">Apache</a> to <a href="http://wiki.nginx.org">Nginx</a>.</p>
<p></div>
  
  
    <footer>
      <a rel="full-article" href="/2009/12/14/configuring-and-compiling-nginx-and-php-fpm-on-ubuntu-for-magento-part-1/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/11/26/book-review-magento-beginners-guide/">Book Review: Magento Beginner&#8217;s Guide</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-26T21:05:00-06:00" pubdate data-updated="true">Nov 26<span>th</span>, 2009</time>
        
         | <a href="/2009/11/26/book-review-magento-beginners-guide/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I was recently approached by <a href="http://www.packtpub.com/">&#91;packt&#93; Publishing</a> to do a review of their book, the <strong>Magento Beginner&#8217;s Guide</strong> (by <a href="http://williamriceinc.blogspot.com/">William Rice</a>). I&#8217;ve been working with Magento a lot over the past year and blog about it here from time to time, so they figured I would be good to review it. After setting up, modifying and maintaining four Magento stores in the last 10 months I don&#8217;t feel I have much to learn from a &#8220;beginners guide&#8221;, but I figured I could use my experience of what a beginner actually needs to know and see if this book covers all the bases.</p>
<p>I have read parts of the official <a href="http://www.magentocommerce.com/support/magento-user-guide-book">Magento User Guide</a> (and <a href="http://www.amazon.com/gp/product/0973862173?ie=UTF8&amp;tag=oronaut-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0973862173">php/architect&#8217;s Guide to E-Commerce Programming with Magento</a>) but this book fills a different gap than the others. The User Guide covers all of the features, but it is not a practical guide. (The programming book was great, but did not cover how to actually use Magento). My favorite thing about the Beginner&#8217;s Guide is that it showed how to use Magento in a practical, day-to-day way. Being just a &#8220;beginner&#8217;s guide&#8221; it does not cover all of the features, but it covers a wide swath of the important ones. What really impressed me was the way it provided tips on how to deal with and overcome some of Magento&#8217;s serious (and occasionally deal-breaking) problems that make the day-to-day administration of an online store difficult.</p>
<p></div>
  
  
    <footer>
      <a rel="full-article" href="/2009/11/26/book-review-magento-beginners-guide/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/11/01/a-simple-fbjs-image-carousel-or-slideshow-for-facebook-page-tabs/">A Simple FBJS Image Carousel (or Slideshow) for Facebook Page Tabs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-01T23:19:00-06:00" pubdate data-updated="true">Nov 1<span>st</span>, 2009</time>
        
         | <a href="/2009/11/01/a-simple-fbjs-image-carousel-or-slideshow-for-facebook-page-tabs/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><span style="font-size: .9em; font-style: italic;">(<strong>Plug</strong>: Looking for an easy, fast, affordable way to create custom Facebook landing tabs? Check out my new product: <a href="http://www.splashtab.com">http://splashtab.com</a> Thanks!)</span></p>
<p>This little code snippet is really basic, and not actually that good or clever. You can make a much nicer slideshow or carousel if you put a little time into it. But I just want to demonstrate how many of the nice JavaScript effects we are used to on the &#8220;Web 2.0&#8221; are also possible on a Facebook Page via Facebook&#8217;s <a href="http://wiki.developers.facebook.com/index.php/FBJS/Animation">Animate library</a>. It&#8217;s not as robust as <a href="http://jquery.com/">jQuery</a> or <a href="http://script.aculo.us/">Scriptaculous</a>, but since you can&#8217;t import those libraries to a Tab the Animate library will have to do. :)</p>
<p>The final result looks like this:<br />
<img alt="Screenshot of the Chili Pepper Design Facebook image carousel" src="http://www.chilipepperdesign.com/images/46.jpg" /></p>
<p><strong>And you can view a <a href="http://www.facebook.com/pages/Bozeman-MT/Chili-Pepper-Design/59282833907?v=app_154473727596">live demo on the <span class="caps">CPD</span> Facebook Page</a></strong></p>
<p>For instructions on how to create your own custom Facebook tabs, <a href="http://www.chilipepperdesign.com/2009/10/11/how-to-make-custom-facebook-fan-page-tabs-with-fbml-part-2">read my tutorial here</a>.</p>
<p>To begin, here is the simple <span class="caps">FBJS</span> &lt;script&gt; code:</p>
<p></div>
  
  
    <footer>
      <a rel="full-article" href="/2009/11/01/a-simple-fbjs-image-carousel-or-slideshow-for-facebook-page-tabs/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/10/11/how-to-make-custom-facebook-fan-page-tabs-with-fbml-part-2/">How to Make Custom Facebook Fan Page Tabs With FBML, Part 2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-11T22:26:00-05:00" pubdate data-updated="true">Oct 11<span>th</span>, 2009</time>
        
         | <a href="/2009/10/11/how-to-make-custom-facebook-fan-page-tabs-with-fbml-part-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong style="font-size: 1.1em;"><span class="caps">UPDATE</span> 2-14-2011: <a href="http://www.chilipepperdesign.com/2011/02/14/facebook-iframe-tabs-on-pages-no-more-fbml"><span class="caps">FBML</span> is going away &#8211; learn about Facebook iframe tabs on Facebook Pages here</a> </strong></p>
<p><strong style="font-size: 1.1em;"><span class="caps">UPDATE</span> 3-10-2011: <a href="http://www.splashlabsocial.com">Easily create and manage custom Facebook Page Tabs with SplashLab Social &#8211; Now available!</a> </strong></p>
<ul>
	<li><a href="http://www.chilipepperdesign.com/2009/10/06/how-to-make-custom-facebook-fan-page-tabs-with-fbml-part-1">Read Part 1 Here</a>.</li>
	<li>Check out some <a href="http://facebookshowcase.net"><strong>great custom Facebook Pages</strong></a></li>
</ul>
<h2>Quick and Dirty Custom Facebook Page Tabs and Boxes</h2>
<p>The fastest and easiest way to add custom Tabs to a Page is with the <a href="http://www.facebook.com/apps/application.php?id=4949752878">Static <span class="caps">FBML</span> application</a>. A nice visual tutorial of this method is posted on <a href="http://lorrainesiew.wordpress.com/2009/07/04/facebook-pages-introduction-to-fbml/">lorrainesiew.wordpress.com</a>. I will also quickly outline the process here:</p>
<p></div>
  
  
    <footer>
      <a rel="full-article" href="/2009/10/11/how-to-make-custom-facebook-fan-page-tabs-with-fbml-part-2/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/10/06/how-to-make-custom-facebook-fan-page-tabs-with-fbml-part-1/">How to Make Custom Facebook Fan Page Tabs With FBML, Part 1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-06T00:10:00-05:00" pubdate data-updated="true">Oct 6<span>th</span>, 2009</time>
        
         | <a href="/2009/10/06/how-to-make-custom-facebook-fan-page-tabs-with-fbml-part-1/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong style="font-size: 1.1em;"><span class="caps">UPDATE</span> 2-14-2011: <a href="http://www.chilipepperdesign.com/2011/02/14/facebook-iframe-tabs-on-pages-no-more-fbml"><span class="caps">FBML</span> is going away &#8211; learn about Facebook iframe tabs on Facebook Pages here</a> </strong></p>
<p><strong style="font-size: 1.1em;"><span class="caps">UPDATE</span> 3-10-2011: <a href="http://www.splashlabsocial.com">Easily create and manage custom Facebook Page Tabs with SplashLab Social &#8211; Now available!</a> </strong></p>
<p>If you have started to dabble in the new wave of &#8220;social media marketing&#8221; you probably made your business/brand/company/band/etc a <a href="http://www.facebook.com/advertising/?pages">Facebook Fan Page</a>. These are basically just like regular Facebook user profiles except instead of a business having &#8220;friends&#8221;, they have what are (more accurately) called &#8220;fans&#8221;. This seems like a good idea since Pages provide a great way for companies to interact with their customers. That part of Fan Pages <strong>is</strong> a good idea, and everyone seems to have a link to &#8220;find us on facebook!&#8221; now because of it! But there are challenges.</p>
<p>It&#8217;s hard to brand a Facebook Page. You can change the Profile Picture and upload photos and videos, etc, but it all feels very much like Facebook still. This consistent visual look is one of the great things about Facebook, but if someone finds your company on Facebook before ever visiting your regular website, your ability to educate the visitor about your products or services is extremely limited. And if you send someone to your Facebook Page from your regular website, there is no clear way to route them back to where the sale will actually be made. It can be a problem. Once they hit Facebook you are at the mercy of whatever users post on the Wall or write in the Reviews tab.</p>
<p></div>
  
  
    <footer>
      <a rel="full-article" href="/2009/10/06/how-to-make-custom-facebook-fan-page-tabs-with-fbml-part-1/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/09/23/custom-loops-for-custom-taxonomies-in-wordpress-28/">Custom Loops for Custom Taxonomies in WordPress 2.8</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-23T18:24:00-05:00" pubdate data-updated="true">Sep 23<span>rd</span>, 2009</time>
        
         | <a href="/2009/09/23/custom-loops-for-custom-taxonomies-in-wordpress-28/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://codex.wordpress.org/Version_2.8">WordPress 2.8</a> saw a big expansion and enhancement of it&#8217;s <a href="http://codex.wordpress.org/WordPress_Taxonomy">Taxonomy <span class="caps">API</span></a>, allowing for easy creation of custom taxonomies. The default WordPress &#8220;category&#8221; and &#8220;tag&#8221; taxonomies are sufficient for most blogs, but the ability to define additional sets of terms (&#8220;vocabularies&#8221;) makes the platform a much more flexible and powerful Content Management System than it was before. Ever since <a href="http://justintadlock.com/archives/2009/05/06/custom-taxonomies-in-wordpress-28">Justin Tadlock</a> opened my eyes to how to create and use additional taxonomies, it seems like every WordPress project I work on needs one or two extra vocabularies. :)</p>
<p>Working with Drupal as much as I have, I became very accustomed to having multiple taxonomies. It&#8217;s incredibly useful. A classic example is Movies: each movie has a director, some actors, a year it was made, etc. You <em>could</em> just lump all these together with a bunch of &#8220;tags&#8221; in WordPress, but grouping &#8220;Actor&#8221; and &#8220;Year&#8221; tags together into taxonomies makes site organization and navigation much simpler (and more sensible).</p>
<p>But there are some challenges still to using WordPress taxonomies. While there is some support in the new <span class="caps">API</span> word making queries based on specific taxonomies, there is not a lot. You <em>can</em> filter your Loop by a term in a single taxonomy via the <em>query_posts()</em>, as <a href="http://justintadlock.com/archives/2009/05/06/custom-taxonomies-in-wordpress-28">Justin</a> shows in this example:</p>
<p></div>
  
  
    <footer>
      <a rel="full-article" href="/2009/09/23/custom-loops-for-custom-taxonomies-in-wordpress-28/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/08/25/wordpress-a-loop-inside-of-a-loop-with-working-comments/">WordPress: A Loop Inside of a Loop With Working Comments</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-08-25T15:32:00-05:00" pubdate data-updated="true">Aug 25<span>th</span>, 2009</time>
        
         | <a href="/2009/08/25/wordpress-a-loop-inside-of-a-loop-with-working-comments/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I was faced with a problem while creating a WordPress theme the other day. I was grouping posts together using a 2.8 <a href="http://justintadlock.com/archives/2009/05/06/custom-taxonomies-in-wordpress-28">custom taxonomy</a> (which is my new favorite thing in WordPress), and wanted to display a list of all related posts above the Comments template. Basically wanted a small <a href="http://codex.wordpress.org/The_Loop">Loop</a> inside of the main Loop &#8211; a loop within a loop.</p>
<p>I found a few pages online which address this, such as <a href="http://lohmantrading.com/Fourced/2009/08/wordpress-loop-inside-of-a-loop/">WordPress Loop Inside of a Loop</a> and <a href="http://www.tyssendesign.com.au/articles/calling-a-wordpress-loop-from-inside-a-wordpress-loop/">Calling a WordPress Loop from inside a WordPress Loop</a>. The idea is pretty simple, and these techniques work fine most of the time.</p>
<p>Everything looked fine to me, as well, until I hit &#8220;Submit Comment&#8221; to test it&#8230; <em>and the comment appeared on the wrong post</em>.</p>
<p>The problem is that inner loop sets the global <em>$post</em> object to the last item in that loop. The methods <em>the_post()</em> and <em>setup_postdata($post)</em> set up the global variables which are needed by <em>the_permalink()</em>, <em>the_title()</em>, <em>comments_template()</em>, etc. So if you call any of these usual &#8220;Loop&#8221; methods again <span class="caps">AFTER</span> the inner loop, they are operating on the <em>last post in the inner loop</em> instead of the <em>current post in the main loop</em>.</p>
<p>The trick is to save the <em>$post</em> objects before the inner loop and to reset them again after the inner loop. To do this, change the Loop structure to follow this template:<br />
<br /></p>
<div><pre><code>$posts = get_posts($wp_query->query);  //get the posts
foreach($posts as $post) :   // cycle through them in the main loop
	$currentPost = $post;  // save the current "main loop" post 
	setup_postdata($post);  // instantiate the global post variables to the main loop post
	the_title();    // use your usual Loop methods 
	the_content();

$innerposts = get_posts('order=asc&mytaxonomy=mycustomerterm);  //get the posts from my custom taxonomy
	foreach($innerposts as $post) :   // cycle through them in the main loop
		setup_postdata($post);  // instantiate the global post variables to the inner loop post
		the_title();    // the inner loop post's title
	endforeach;  // end of inner loop

$post = $currentPost;  // reset the post from the main loop
	$id = $post->ID;  // reset the post from the main loop
	comments_template();  // now, the comments for the post in the main loop
endforeach;  // end of main loop</code></pre></div><p>Another way to do this might be to <span class="caps">NOT</span> set the global variables in the inner loop, thus avoiding this issue with the comments entirely. You would just have to directly access the post variables in the inner loop, i.e. <em>$rel_post&#8594;post_title</em> instead of <em>the_title()<em>. It would work for simple things, like the title and slug. Check out <a href="http://codex.wordpress.org/Displaying_Posts_Using_a_Custom">custom select query</a></em>Select</em>Query in the WordPress Codex to figure out how to get all of the fields you need from the DB to use this method.</p></div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img id="profile-image" src="http://www.gravatar.com/avatar/02bee2f91e0a8c3aefbfa6bfb5304c51" alt="Gravatar of thaddeusmt " title="Gravatar of thaddeusmt" />My name is Evan Johnson. I&#8217;m a software developer from Montana, who spent some time in Nebraska. I&#8217;m the chief software architect at <a href="http://splashlabsocial.com">SplashLab Social</a>, but I am blogging here on my old freelance web design URL for fun. I hope you find something useful here, thanks for visiting! Cheers</p>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2012/12/27/new-hipster-hacker-octopress-blog/">New Hipster Hacker Blog</a>
      </li>
    
      <li class="post">
        <a href="/2011/05/15/magento-15-ee-110-windows-command-line-batch-update-script-magebat/">Magento 1.5 / EE 1.10 Windows Command Line Batch Update Script mage.bat</a>
      </li>
    
      <li class="post">
        <a href="/2011/02/15/reveal-fan-gate-like-gate-facebook-iframe-tab-tutorial-with-php/"> Reveal / Fan-Gate / Like-Gate Facebook iframe tab tutorial (with PHP)</a>
      </li>
    
      <li class="post">
        <a href="/2011/02/14/facebook-iframe-tabs-on-pages-no-more-fbml/">Facebook iframe tabs on Pages - No more FBML!</a>
      </li>
    
      <li class="post">
        <a href="/2010/03/24/a-facebook-content-management-system-cms-for-facebook-page-templates/">A Facebook Content Management System (CMS) for Facebook Page Templates</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/categories/apache/'>Apache (1)</a></li>
<li class='category'><a href='/categories/css/'>CSS (2)</a></li>
<li class='category'><a href='/categories/drupal/'>Drupal (2)</a></li>
<li class='category'><a href='/categories/facebook/'>Facebook (6)</a></li>
<li class='category'><a href='/categories/javascript/'>JavaScript (3)</a></li>
<li class='category'><a href='/categories/linux/'>Linux (3)</a></li>
<li class='category'><a href='/categories/magento/'>Magento (11)</a></li>
<li class='category'><a href='/categories/meta/'>Meta (3)</a></li>
<li class='category'><a href='/categories/nginx/'>Nginx (3)</a></li>
<li class='category'><a href='/categories/reviews/'>Reviews (1)</a></li>
<li class='category'><a href='/categories/ruby-/'>Ruby, (1)</a></li>
<li class='category'><a href='/categories/seo/'>SEO (2)</a></li>
<li class='category'><a href='/categories/web-development/'>Web-Development (19)</a></li>
<li class='category'><a href='/categories/wordpress/'>WordPress (3)</a></li>

  </ul>
</section>
<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("thaddeusmt", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/thaddeusmt" class="twitter-follow-button" data-show-count="false">Follow @thaddeusmt</a>
  
</section>

<section>
  <h1>StackOverflow</h1>
  <a id="stackoverflow-badge" href="http://stackoverflow.com/users/164439/thaddeusmt"><img src="http://stackoverflow.com/users/flair/164439.png" width="208" height="58" alt="profile for thaddeusmt at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for thaddeusmt at Stack Overflow, Q&amp;A for professional and enthusiast programmers"></a>
</section>
<section>
  <h1>Coderwall</h1>
  <ul id="cw_badges">
    <li class="loading">Status updating&#8230;</li>
  </ul>

  <script type="text/javascript">
    var coderwall = (function(){
      function render(options, badges){
        var fragment = '',
            t = $(options.target)[0],
            height = 65,
            width = 65,
            index;

        for (index in badges) {
          fragment += '<a class="cw_badge"title="' + badges[index].description + '" href="http://coderwall.com/' + options.user + '">';
          fragment +=   '<img alt="' + badges[index].description + '" height="' + width + '" width="' + height + '" src="' + badges[index].badge + '"/>';
          fragment += '</a>';
        }

        t.innerHTML = fragment;
      }
      return {
        showBadges: function(options){
          $.ajax({
              url: 'http://coderwall.com/' + options.user + '.json?callback=?'
            , type: 'jsonp'
            , error: function (err) { $(options.target + ' li.loading').addClass('error').text("Error loading feed"); }
            , success: function(res) {
                render(options, res.data.badges);
            }
          });
        }
      };
    })();

    $.domReady(function(){
      if (!window.jXHR){
        var jxhr = document.createElement('script');
        jxhr.type = 'text/javascript';
        jxhr.src = '/javascripts/libs/jXHR.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(jxhr, s);
      }
      if (!window.$){
        var b = document.createElement('script');
        b.type = 'text/javascript';
        b.src = '/javascripts/ender.js';
        var sc = document.getElementsByTagName('script')[0];
        sc.parentNode.insertBefore(jxhr, s);
      }
      coderwall.showBadges({
        user: 'thaddeusmt',
        target: '#cw_badges'
      });
    });
  </script>
  <style type="text/css">
    .cw_badge img {
      padding: 5px;
      border: 0 none !important;
      -moz-box-shadow: none !important;
      -webkit-box-shadow: none !important;
      -o-box-shadow: none !important;
      box-shadow: none !important;
    }
  </style>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Evan Johnson -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
    function stripTrailingSlash(str) {
        if(str.substr(-1) == '/') {
            return str.substr(0, str.length - 1);
        }
        return str;
    }
      var disqus_shortname = 'chilipepperdesign';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
